<div class="app-main__inner">
    <div class="app-page-title add-project-title">
        <div class="page-title-wrapper">
            <div class="page-title-heading">
                Add Offers
            </div>
        </div>
    </div>
    <div class="tab-content">
        <div class="tab-pane tabs-animation fade show active" id="tab-content-0" role="tabpanel">
            <div class="row">
                <div class="col-md-12">
                    <div class="main-card mb-3 card">
                        <div class="card-body">
                            <form [formGroup]="addOfferForm" (ngSubmit)="submit(addOfferForm.value)">
                                <div class="row">
                                    <div class="col-lg-{{colSize}} col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="name">
                                            <mat-label>Offer Name<span class="starmandatory">*</span></mat-label>
                                            <input matInput formControlName="name" placeholder="Offer Name" type="text">
                                            <mat-error *ngIf="addOfferForm.get('name')?.touched">Offer Name is required!
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="form-group col-lg-{{colSize}} col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="OfferType">
                                            <mat-label>Offer Type<span class="starmandatory">*</span></mat-label>
                                            <mat-select formControlName="type" (selectionChange)="GetOfferType($event)">
                                                <mat-option>--Select Offer Type--</mat-option>
                                                <mat-option value="Area Wise">Area Wise</mat-option>
                                                <mat-option value="Product Giveaway">Product Giveaway</mat-option>
                                                <mat-option value="Direct Discount(in Rs)">Direct Discount(in Rs)
                                                </mat-option>
                                                <mat-option value="Direct Discount(in Percentage)">Direct
                                                    Discount(in Percentage)</mat-option>
                                                <mat-option value="Lucky Draw">Lucky Draw</mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="addOfferForm.get('type')?.touched">Offer Type is required!
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-lg-{{colSize}} col-sm-12 col-md-12" [style.display]="offer_type">
                                        <mat-form-field appearance="outline" id="Disc">
                                            <mat-label id="offertypelbl">{{showofferlbl}}<span class="starmandatory">*</span></mat-label>
                                            <input matInput formControlName="benefit" placeholder={{showofferlbl}}
                                                type="text">
                                            <mat-error *ngIf="addOfferForm.get('benefit')?.touched">Benefit is required!
                                            </mat-error>
                                            <mat-error style="position: relative;left: 6rem;bottom: 1.55rem;" *ngIf="addOfferForm.get('benefit')?.hasError('pattern')">
                                                Enter only number.
                                              </mat-error>
                                        </mat-form-field>
                                        
                                    </div>
                                    
                                 
                                    <div class="col-lg-{{colSize}} col-sm-12 col-md-12" [style.display]="offer_giveaway">
                                        <mat-form-field appearance="outline" id="Disc">
                                            <mat-label id="offertypelbl">Product discription<span class="starmandatory">*</span></mat-label>
                                            <input matInput formControlName="product_description" placeholder={{showofferDesc}}
                                                type="text">
                                            <mat-error *ngIf="addOfferForm.get('product_description')?.touched">Description is required!
                                            </mat-error>
                                            <mat-error style="position: relative;left: 6rem;bottom: 1.55rem;" *ngIf="addOfferForm.get('product_description')?.hasError('pattern')">
                                                Enter only number.
                                              </mat-error>
                                        </mat-form-field>
                                     </div>
                                    
                                    <div class="col-lg-{{colSize}} col-sm-12 col-md-12" [style.display]="offer_giveaway">
                                        <mat-form-field appearance="outline" id="Disc">
                                            <mat-label id="offertypelbl">Price (in Rs)<span class="starmandatory">*</span></mat-label>
                                            <input matInput formControlName="product_price" placeholder={{showofferPrice}}
                                                type="text">
                                            <mat-error *ngIf="addOfferForm.get('product_price')?.touched">Price is required!
                                            </mat-error>
                                            <mat-error style="position: relative;left: 6rem;bottom: 1.55rem;" *ngIf="addOfferForm.get('product_price')?.hasError('pattern')">
                                                Enter only number.
                                              </mat-error>
                                        </mat-form-field>
                                        
                                    </div>

                                    <div class="col-lg-{{colSize}} col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="sdate">
                                            <mat-label>Offer Start Date</mat-label>
                                            <!-- <input matInput  [matDatepicker]="picker" placeholder="Select Start Date"
                                                formControlName="start_date"> -->
                                                <input matInput id="dateVal" (dateChange)="getStartDate($event)" [matDatepicker]="startDatepicker"
                                                 [value]="sDate"  formControlName="start_date">
                                            <mat-datepicker-toggle matSuffix [for]="startDatepicker"></mat-datepicker-toggle>
                                            <mat-datepicker #startDatepicker></mat-datepicker>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-lg-3 col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="edate">
                                            <mat-label>Offer End Date</mat-label>
                                            <input matInput  [min]="startDate" [disabled]="getEndDate" [matDatepicker]="pickerend" placeholder="Select End Date"
                                                formControlName="end_date">
                                            <mat-datepicker-toggle matSuffix [for]="pickerend"></mat-datepicker-toggle>
                                            <mat-datepicker #pickerend></mat-datepicker>
                                            <!-- <mat-error *ngIf="addOfferForm.get('end_date')">End date must be after start date</mat-error> -->
                                        </mat-form-field>
                                       
                                    </div>
                                    <div class="col-lg-2 col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="offercount">
                                            <mat-label>Offer Counts</mat-label>
                                            <input matInput placeholder="Offer Counts" type="number" min="0" (keypress)="numberOnly($event)" formControlName="counts" [readonly] = "OCounts"  [(ngModel)]="AllOffer">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-lg-1 col-sm-12 col-md-12" >
                                        <div class="All">
                                        <mat-checkbox  [checked]="checkedAll"  formControlName="projectData"  (change)="offerForAll($event)"> 
                                            All
                                        </mat-checkbox>
                                    </div>
                                    </div>
                                    <div class="form-group col-lg-3 col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="OfferType" >
                                            <mat-label>Applicable for Payment Type</mat-label>
                                            <mat-select formControlName="applicable_on_payment_type">
                                                <mat-option value="Full">Full</mat-option>
                                                <mat-option value="Installment">Installment</mat-option>
                                                <mat-option value="">Both</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-lg-3 col-sm-12 col-md-12">
                                        <div class="row form-check form-check-inline">
                                            <mat-label>Is this offer applicable for particular Projects</mat-label>
                                            <div class="col-md-6">
                                                <input type="radio" class="form-check-input" id="rd1" [checked]='true'
                                                selected
                                                    (change)="changeEvent($event)" name="applicable_projects"
                                                    value="Yes" />
                                                <label for="yes">Yes</label>
                                            </div>
                                            <div class="col-md-6">
                                                <input type="radio" class="form-check-input" id="rd1"  (change)="changeEvent1($event)" name="applicable_projects"
                                                    value="No" />
                                                <label for="no">No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row" [style.display]="applicable_for_project">
                                    <div class="col-lg-3 col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Select Project</mat-label>
                                            <mat-select formControlName="applicable_on_project_id"
                                                (selectionChange)="GetProject($event)" (ngModelChange)="clearvalue($event)">
                                                <mat-option *ngFor="let project of userProjects" value="{{project.id}}">
                                                    {{project.name}}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-lg-3 col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Select Property Type : </mat-label>
                                            <mat-select multiple  (selectionChange)="GetPropertyDetails($event)" formControlName="applicable_on_property_type">
                                                 <mat-option *ngFor="let propertyType of new1p" 
                                                    value="{{propertyType.id}}">
                                                         {{propertyType.name}}    
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-lg-3 col-sm-12 col-md-12">
                                        <mat-form-field appearance="outline" id="propertyid">
                                            <mat-label>Select Property</mat-label>
                                            <input matInput type="text"
                                                class="searchBox" value={{searchData}} placeholder="Search Property" (keyup)="search_Property($event)">
                                                <!-- <span *ngFor="let show of propertyNumberShow">{{show+','}}</span>  -->
                                        </mat-form-field>
                                        <div *ngIf="isProperty" class="existing-token-dropdown" [style.display]="showListofProperty">
                                            <ul class="nav"  *ngFor="let property of PropertyData" >
                                                <li class="nav-item exist-token-list">
                                                   <input #checkBox type="checkbox" multiple  (click)="GetSearchPPT($event)" value="{{property.id}}" >
                                                        {{property.number}}
                                                </li>                                               
                                            </ul> 
                                        </div> 
                                        <p class="no_record" *ngIf="noRecords">No record found!</p>
                                    </div>
                                </div>
                                  <div class="row">
                                    <div class="col-md-10">
                                       <span> Search Properties</span>
                                       <ng-container *ngIf="isProperty">
                                          <span class="selected-properties"
                                        *ngFor='let property of selectedProperty;let i = index'>{{property.number}}
                                        <mat-icon (click)="deleteProperty(i)" class="close-btn close-property">close</mat-icon>
                                    </span>
                                       </ng-container>
             
                                     </div>
                               </div>
                               
                                <button type="submit" [disabled]="!addOfferForm.valid"
                                    class="mt-1 btn btn-primary">Save</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>