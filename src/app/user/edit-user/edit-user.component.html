<div class="app-main__inner">
    <div class="app-page-title add-project-title">
        <div class="page-title-wrapper">
            <div class="page-title-heading">
                <!-- Edit User -->
            </div>

        </div>
    </div>

    <div class="tab-content">
        <div class="tab-pane tabs-animation fade show active" id="tab-content-0" role="tabpanel">

            <div class="row width-row" *ngIf="!edit">

                <!-- <i class="fas fa-edit edit-button" (click)="editUser()"></i> -->
                <mat-icon class="edit-button" (click)="editUser()" >edit</mat-icon>

                <div class="col-lg-12 col-sm-12 profile-col column-center ">

                    <div class="profile-margin">
                        <img id="blah" class="small-image" alt="" src="{{UserPreviousImage?UserPreviousImage:''}}" />
                        <input type="file" style="display: none;" (change)="userImage($event)" #file />
                    </div>
                    <div class="row">
                        <div class="form-group col-lg-12 col-md-12 col-sm-12">
                            <div class="color-name">{{Name}}</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-lg-12 col-md-12 col-sm-12">
                            {{Role}}
                        </div>

                    </div>
                    <div class="row">
                        <div class="form-group col-lg-12 col-md-12 col-sm-12">
                            {{Gender}}
                        </div>
                    </div>

                    <!-- <div class="row" *ngFor="let project of Project">
                        <div class="form-group form-group col-lg-4 col-md-6
                                        col-sm-12">
                            <ol>
                                <li style="position: relative;right: 10px;">{{project.name}}</li>
                            </ol>
                        </div>

                        <div class="form-group form-group col-lg-4 col-md-6
                                        col-sm-12" *ngFor="let department of newDepts">
                            <ol *ngFor="let pDept of project.departments[0]">
                                <li style="position: relative;right: 10px;" *ngIf="department.id == pDept">{{department.name}}</li>
                            </ol>
                        </div>

                    </div> -->
                    <div *ngFor="let project of Project">
                        <table class="table" >
                            <thead>
                              <tr>
                                  <!-- <th  scope="col">1</th> -->
                                <th scope="col">{{project.name}}</th>
                               
                              </tr>
                            </thead>
                            <tbody  *ngFor="let department of newDepts">
                              <tr *ngFor="let pDept of project.departments[0]">
                                <!-- <th scope="row">a</th> -->
                                <td scope="row" *ngIf="department.id == pDept">{{department.name}}</td>
                               
                                
                              </tr>
                            
                              
                            </tbody>
                          </table>
                    </div>

                    <!-- <div class="container">
                        <div class="row" *ngFor="let project of Project">
                            <div class="col">
                                <ol>
                                    <li style="position: relative;right: 10px;">{{project.name}}</li>
                                </ol>

                            </div>
                            <div class="row">
                            <div class="col" *ngFor="let department of newDepts">
                                <ol *ngFor="let pDept of project.departments[0]">
                                    <li style="position: relative;right: 10px;" *ngIf="department.id == pDept">{{department.name}}</li>
                                </ol>
                            </div>
                        </div>

                        </div>
                    </div> -->

                    <hr>
                    <div class="row">
                        <div class="form-group col-lg-12 col-md-12 col-sm-12">
                            {{Email}}
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-lg-12 col-md-12 col-sm-12">
                            {{Phone}}
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-lg-12 col-md-12 col-sm-12">
                            <div class="set-margin">
                                {{Address}}, {{City}} {{PostalCode}} {{State}}
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="form-group col-lg-12 col-md-6 col-sm-12">
                            {{Country}}
                        </div>

                    </div>
                </div>
            </div>
        </div> <!-- view user form end-->


        <!-- edit user form  -->

        <div class="row edit-display" *ngIf="edit">

            <div class="col">
                <form [formGroup]="editUserForm" (ngSubmit)="submit(editUserForm.value)">
                    <div class="row first-row-height">

                        <div class="col-md-3 col-sm-12 profile-col">

                            <div class="profile-div">
                                <!-- <i class="fas fa-user-circle" class="display:none"></i> -->
                                <mat-icon class="highlight" (click)="deleteImg()" style="cursor:pointer;">highlight_off</mat-icon>
                                <img id="blah" alt="" src="{{UserPreviousImage}}" />

                                <input type="file" style="display: none;" (change)="userImage($event)" #file />
                                <mat-icon class="camera-icon" (click)="file.click()">camera_enhance</mat-icon>
                            </div>

                        </div>

                        <div class="col-md-8 col-sm-12">
                            <div class="row">
                                <div class="form-group col-lg-4 col-md-6
                                        col-sm-12">
                                    <mat-form-field appearance="outline" id="NameField">
                                        <mat-label>Name<span class="starmandatory">*</span></mat-label>
                                        <input matInput formControlName="name" placeholder="">
                                        <mat-error *ngIf="editUserForm.get('name')?.touched">Name is required!
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="form-group col-lg-4 col-md-6
                                        col-sm-12">
                                    <mat-form-field appearance="outline" id="gender">
                                        <mat-label>Gender<span class="starmandatory">*</span></mat-label>
                                        <mat-select formControlName="gender">
                                            <mat-option>Select Gender</mat-option>
                                            <mat-option value="Male">Male</mat-option>
                                            <mat-option value="Female">Female</mat-option>
                                            <mat-option value="Others">Others</mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="editUserForm.get('gender')?.touched">Gender is required!
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="form-group col-lg-4 col-md-6
                                        col-sm-12">
                                    <mat-form-field appearance="outline" id="EmailField">
                                        <mat-label>Email<span class="starmandatory">*</span></mat-label>
                                        <input matInput formControlName="email" placeholder="">
                                        <mat-error *ngIf="editUserForm.get('email')?.touched">Email is required!
                                        </mat-error>
                                    </mat-form-field>
                                </div>


                                <div class="form-group col-lg-4 col-md-6
                                        col-sm-12">
                                    <mat-form-field appearance="outline" id="PhoneField">
                                        <mat-label>Phone No.<span class="starmandatory">*</span></mat-label>
                                        <input matInput formControlName="phone" placeholder="">
                                        <mat-error *ngIf="editUserForm.get('phone')?.touched">Phone is required!
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="form-group col-lg-4 col-md-6
                                        col-sm-12">
                                    <mat-form-field appearance="outline" id="AltPhoneField">
                                        <mat-label> Alternate Phone No.</mat-label>
                                        <input matInput formControlName="alternate_phone" placeholder="">
                                    </mat-form-field>
                                </div>
                                <div class="form-group col-lg-4 col-md-6
                                        col-sm-12">
                                    <mat-form-field appearance="outline" id="RoleField">
                                        <mat-label>Select Role<span class="starmandatory">*</span></mat-label>
                                        <mat-select formControlName="role_id">
                                            <mat-option *ngFor="let role of
                                                    roles" [value]="role.id">{{role.name}}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="editUserForm.get('role_id')?.touched">Role is required!
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="col-md-1 col-sm-12"></div>
                        </div>

                    </div>


                    <div class="row row-bottom-1">
                        <ng-container  formArrayName="projects">
                            <ng-container *ngFor="let fields of projectDepts().controls; let i=index" [formGroupName]="i">
                        <div class="form-group col-lg-3 col-md-6 col-sm-12"></div>
                        <ng-container *ngIf="i<projects.length">
                               <div class="form-group col-lg-4 col-md-6 col-sm-12">
                            <mat-form-field appearance="outline" id="ProjectField" class="second-col">
                                <mat-label>Select Project<span class="starmandatory">*</span></mat-label>
                                <mat-select formControlName="id" (selectionChange)="GetProject($event,i)">
                                    <mat-option>None</mat-option>
                                    <mat-option *ngFor="let project of
                                            projects" [value]="project.id">
                                        {{project.name}}</mat-option>
                                </mat-select>
                                <mat-error *ngIf="editUserForm.get('projects')?.touched">Project is required!
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="form-group col-lg-3 col-md-6 col-sm-12">
                            <mat-form-field appearance="outline" id="DepartmentField" class="second-col"
                                (click)="showMsg()">
                                <mat-label>Select Department<span class="starmandatory">*</span></mat-label>
                                <mat-select multiple  formControlName="departments">
                                    <!-- <mat-option>None</mat-option> -->
                                    <mat-option *ngFor="let dept of projects[projectIdIndex[i]].Departments" [value]="dept.id">{{dept.name}}
                                    </mat-option>
                                </mat-select>
                                <mat-error *ngIf="editUserForm.get('department_id')?.touched">Department is required!
                                </mat-error>
                            </mat-form-field>
                            <!-- <span id="deptErr" style="display: none;">please select project first !</span> -->
                        </div>
                          <div *ngIf="i!=0" class="text-center form-group col-lg-1 col-sm-12 ">
                            <button  mat-mini-fab type="button" color="warn"  (click)="removeField(i)"
                                aria-label="Example icon button with a menu icon">
                                <mat-icon>clear</mat-icon>
                            </button>
                        </div>
                        </ng-container>
                     
                      
                        </ng-container>
                        </ng-container>
                        <div class="form-group col-lg-1 col-sm-12">
                            <button [disabled]="isAddDisabled" (click)="addProject()" mat-mini-fab type="button" color="primary"
                                aria-label="Example icon button with a menu icon">
                                <mat-icon>add</mat-icon>
                            </button>
                        </div> 
                    </div>
                    
                    <ng-container formGroupName="address">
                        <div class="row  row-bottom-2">
                            <div class="form-group col-lg-3 col-md-6
                                    col-sm-12"></div>
                            <div class="form-group col-lg-8 col-md-6
                                    col-sm-12">
                                <mat-form-field appearance="outline" class="second-col address-line-height">
                                    <mat-label>Address<span class="starmandatory">*</span></mat-label>
                                    <textarea matInput formControlName="address" placeholder="Address"></textarea>
                                    <mat-error *ngIf="editUserForm.get('address')?.touched">Address is required!
                                    </mat-error>
                                </mat-form-field>
                            </div>

                            <div class="form-group col-lg-1 col-md-6
                                    col-sm-12"></div>

                        </div>

                        <div class="row  row-bottom-3">
                            <div class="form-group col-lg-3 col-md-6
                                    col-sm-12"></div>
                            <div class="form-group col-lg-2 col-md-6
                                    col-sm-12">
                                <mat-form-field appearance="outline" id="PinField" class="second-col">
                                    <mat-label>Pin Code</mat-label>
                                    <input matInput formControlName="postal_code" placeholder="Pin No.">
                                </mat-form-field>
                            </div>
                            <div class="form-group col-lg-2 col-md-6
                                    col-sm-12">
                                <mat-form-field appearance="outline" id="CityField" class="second-col">
                                    <mat-label> City</mat-label>
                                    <input matInput formControlName="city" placeholder="City">
                                </mat-form-field>
                            </div>


                            <div class="form-group col-lg-2 col-md-6
                                    col-sm-12">
                                <mat-form-field appearance="outline" id="StateField" class="second-col">
                                    <mat-label>State</mat-label>
                                    <input matInput formControlName="state" placeholder="State">
                                </mat-form-field>
                            </div>
                            <div class="form-group col-lg-2 col-md-6
                                    col-sm-12">
                                <mat-form-field appearance="outline" id="CountryField" class="second-col">
                                    <mat-label> Country</mat-label>
                                    <input matInput formControlName="country" placeholder="Country">
                                </mat-form-field>
                            </div>
                            <div class="form-group col-lg-1 col-md-6
                                    col-sm-12">

                            </div>


                        </div>
                    </ng-container>
                    <div class="row  row-bottom-4">
                        <div class="form-group col-lg-3 col-md-6
                                col-sm-12">
                        </div>
                        <div class="form-group col-lg-8 col-md-6
                                col-sm-12">
                                <ng-container *ngFor="let feature of userFeature"> 
                            <button *ngIf="feature.update==true" style="float: right;" [disabled]="!editUserForm.valid" type="submit" class="mt-1
                                    btn btn-primary button-width">Save</button>
                                    </ng-container>
                        </div>

                        <div class="form-group col-lg-1 col-md-6
                                col-sm-12">
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>